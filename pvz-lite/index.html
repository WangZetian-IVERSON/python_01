<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PVZ-Lite 框架</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="app">
      <div class="sidebar">
        <h1>PVZ-Lite</h1>
        <section>
          <h2>植物库</h2>
          <div id="plant-palette" class="palette"></div>
          <div class="hint">点击选择植物，再点击草地格子进行放置</div>
        </section>
            <label>
              模型 ID/本地路径（可选）
              <input type="text" id="gen-model" placeholder=".. 或 F:/models/sdxl" />
            </label>
        <section>
          <h2>自定义植物</h2>
          <form id="custom-plant-form">
            <label>
              名称
              <input type="text" name="name" placeholder="我的植物" required />
            </label>
            <div class="row-2">
            <label>
              负面提示词（可选）
              <textarea id="gen-neg" rows="2" placeholder="blur, lowres, watermark, text"></textarea>
            </label>
              <label>
                生命
                <input type="number" name="maxHealth" min="10" max="1000" step="10" value="100" />
              </label>
              <label>
                费用
                <input type="number" name="cost" min="0" max="999" step="25" value="0" />
              </label>
            </div>
            <div class="row-2">
              <label>
                攻速(每秒)
                <input type="number" name="fireRate" min="0" max="10" step="0.1" value="1.0" />
              </label>
              <label>
                伤害
                <input type="number" name="damage" min="1" max="500" step="1" value="20" />
              </label>
            </div>
            <div class="row-2">
            <div class="row-2">
              <label>
                随机种子（可选）
                <input type="number" id="gen-seed" min="0" step="1" placeholder="随机" />
              </label>
              <div></div>
            </div>
              <label>
                子弹速度
                <input type="number" name="projectileSpeed" min="20" max="600" step="10" value="200" />
              </label>
              <label>
                颜色
                <input type="color" name="color" value="#48c774" />
              </label>
            </div>
            <label>
              图片地址(可选)
              <input type="url" name="imageUrl" placeholder="https://.../plant.png" />
            </label>
            <label>
              或本地图片(可选)
              <input type="file" name="imageFile" accept="image/*" />
            </label>
            <button type="submit">添加到植物库</button>
          </form>
        </section>

        <section>
          <h2>僵尸外观</h2>
          <form id="zombie-form">
            <label>
              僵尸图片地址(可选)
              <input type="url" name="zombieUrl" id="zombie-url" placeholder="https://.../zombie.png" />
            </label>
            <label>
              或本地图片(可选)
              <input type="file" id="zombie-file" accept="image/*" />
            </label>
          </form>
        </section>

        <section>
          <h2>文生图生成(Stable Diffusion)</h2>
          <form id="gen-form">
            <label>
              后端
              <select id="gen-backend">
                <option value="a1111">AUTOMATIC1111 API</option>
                <option value="local">本地 Diffusers 后端</option>
              </select>
            </label>
            <label>
              API 地址
              <input type="url" id="gen-api" placeholder="http://127.0.0.1:7860" value="http://127.0.0.1:7860" required />
            </label>
            <label>
              提示词（中文/英文均可）
              <textarea id="gen-prompt" rows="3" placeholder="A cute green pea shooter, simple icon, clean background"></textarea>
            </label>
            <div class="row-2">
              <label>
                宽度
                <input type="number" id="gen-width" min="128" max="768" step="64" value="256" />
              </label>
              <label>
                高度
                <input type="number" id="gen-height" min="128" max="768" step="64" value="256" />
              </label>
            </div>
            <div class="row-2">
              <label>
                步数(steps)
                <input type="number" id="gen-steps" min="1" max="50" step="1" value="20" />
              </label>
              <label>
                CFG
                <input type="number" id="gen-cfg" min="1" max="20" step="0.5" value="7" />
              </label>
            </div>
            <div class="row-2">
              <label>
                名称
                <input type="text" id="gen-name" placeholder="生成植物" />
              </label>
              <label>
                费用
                <input type="number" id="gen-cost" min="0" max="999" step="25" value="25" />
              </label>
            </div>
            <div class="row-2">
              <label>
                攻速
                <input type="number" id="gen-fireRate" min="0" max="10" step="0.1" value="1.0" />
              </label>
              <label>
                伤害
                <input type="number" id="gen-damage" min="1" max="500" step="1" value="20" />
              </label>
            </div>
            <div class="row-2">
              <label>
                子弹速度
                <input type="number" id="gen-proj" min="20" max="600" step="10" value="220" />
              </label>
              <label>
                放置冷却(s)
                <input type="number" id="gen-cd" min="0" max="60" step="0.5" value="3" />
              </label>
            </div>
            <div class="row-2">
              <button type="button" id="gen-generate">生成</button>
              <button type="button" id="gen-add" disabled>加入植物库</button>
            </div>
            <div id="gen-status" class="hint"></div>
            <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
              <img id="gen-preview" alt="预览" style="width:64px; height:64px; border:1px solid #1f2937; border-radius:8px; object-fit:contain; background:#0d1524;" />
              <span class="hint">生成后可预览并加入植物库</span>
            </div>
          </form>
        </section>
        <section class="status">
          <div>选择的植物：<span id="selected-plant">无</span></div>
          <div>分数：<span id="score">0</span></div>
          <div>阳光：<span id="sun">50</span></div>
          <div>游戏状态：<span id="game-state">准备中</span></div>
          <div class="row-2" style="margin-top:8px;">
            <button id="start-btn" type="button">开始游戏</button>
            <button id="restart-btn" type="button">重新开始</button>
          </div>
        </section>

        <section class="status">
          <h2>经济/统计</h2>
          <div>总阳光获取：<span id="total-sun">0</span></div>
          <div>已花费：<span id="sun-spent">0</span></div>
        </section>

        <section class="status">
          <h2>关卡</h2>
          <div>当前关卡：<span id="level-num">1</span></div>
          <div>目标时间：<span id="level-duration">02:00</span></div>
          <div>已坚持：<span id="level-time">00:00</span></div>
          <div>本关僵尸类型：</div>
          <ul id="level-types" class="hint" style="margin-top:4px;"></ul>
          <div class="row-2" style="margin-top:8px;">
            <button id="next-level-btn" type="button" disabled>下一关</button>
          </div>
        </section>
      </div>
      <div class="stage">
        <canvas id="game-canvas" width="720" height="400"></canvas>
      </div>
    </div>

    <script type="module" src="./src/main.js"></script>
  </body>
  </html>
